!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=2)}([function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e){var t=document.createElement("canvas");t.width=t.height=1;var n=t.getContext("2d");return n.clearRect(0,0,1,1),n.fillStyle=e,n.fillRect(0,0,1,1),[].concat(o(n.getImageData(0,0,1,1).data)).slice(0,3)}function i(e){return r(e).reduce(function(e,t){return e+t},0)/3}Object.defineProperty(t,"__esModule",{value:!0}),t.colorToRGB=r,t.luminance=i},function(e,t,n){"use strict";function o(e,t){function n(e){var t=a+"-minimage-"+d+".png";this.href=r(i,o).toDataURL("image/png",.5),this.download=t,d++}var o=t.OrginalImage,i=t.canvas,a=t.originalFileName,d=0;e.addEventListener("click",n,!1)}function r(e,t){var n=e.getContext("2d"),o=n.globalCompositeOperation;return n.globalCompositeOperation="destination-over",n.drawImage(t,0,0,e.width,e.height),n.globalCompositeOperation=o,e}Object.defineProperty(t,"__esModule",{value:!0}),t.makeDownloadLink=o,t.mergeCanvasAndImage=r},function(e,t,n){e.exports=n(3)},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(e){"eraser"==e?L():b(e)}C=e,E();var n=w("drawzone"),o=w("drawzoneWrapper");o.appendChild(e),w("inputForAFile").style.display="none",w("drawAndDownload").style.display="";var r=Math.max(window.innerHeight,window.innerWidth),i=Math.max(e.width/r,e.height/r,1);e.width=n.width=e.width/i,e.height=n.height=e.height/i,o.style.maxWidth=e.width,o.style.maxHeight=e.height;var d=(n.getContext("2d"),!1),u=w("topbar").classList,c=w("background"),s=(0,a.default)(w("pensizePreview"),{canvasForCursor:n,onColorChange:t,elementToContrastWith:c}),m=s.setColorDotSize,p=s.refreshColorPreviewBorder,h=(0,f.default)(n,{onMouseDown:function(){n.getClientRects()[0].height+140>window.innerHeight&&u.add("drawInProgress")},onMouseUp:function(){d||(d=!0,download.classList.add("usable")),u.remove("drawInProgress")},OrginalImage:C}),b=h.drawWithColor,L=h.drawWithEraser,k=h.setPencilSize;(0,l.default)(c,{onChange:p}),(0,g.default)(w("pensize"),{onChange:function(e){m(e),k(e)}}),(0,v.makeDownloadLink)(w("download"),{OrginalImage:C,originalFileName:y,canvas:n})}n(4);var i=n(5),a=o(i),d=n(7),u=o(d),c=n(9),l=o(c),s=n(10),f=o(s),v=n(1),m=n(11),g=o(m),p=n(12),h=o(p),w=(n(13),document.getElementById.bind(document)),y=void 0,C=void 0;(0,u.default)({fileinput:w("fileinput"),onImageCreated:function(e,t){y=t,r(e)}});var b=(0,h.default)(w("welcome")),E=b.stopAnim,L=b.bgColor;w("fileInputWrapper").style.color=L},function(e,t){},function(e,t,n){"use strict";function o(e,t){if("eraser"==e)return"transparent";var n=(0,c.luminance)(t),o=(0,c.luminance)(e);return n>125&&o>200?"black":n<125&&o<25?"white":"transparent"}function r(e){return(0,c.luminance)(e)>127.5?"rgba(0,0,0,0.8)":"rgba(255,255,255,0.8)"}function i(e,t){function n(e){o(),t(e)}function o(){i.classList.add("closing"),setTimeout(function(){return document.body.removeChild(i)},300)}var i=document.createElement("div");i.classList.add("modal"),document.body.appendChild(i),l.paletteColors.forEach(function(t){var o=document.createElement("button");o.classList.add("colorbutton"),t===e&&(o.classList.add("active"),o.innerHTML="Selected",o.style.color=r(t)),o.style.backgroundColor=t.toLowerCase(),o.addEventListener("click",function(){return n(t)}),i.appendChild(o)});var a=document.createElement("button");a.classList.add("eraser"),a.addEventListener("click",function(){return n("eraser")}),a.innerHTML='<img src="/images/eraser-color.svg"/><span class="imagelabel">'+("eraser"===e?"Eraser selected":"Eraser")+"</span>",i.appendChild(a)}function a(e,t,n){var o=t<4?4:t,r=document.createElement("canvas");r.width=r.height=o;var i=r.getContext("2d");"eraser"==n?u(i,o):d(i,o,n);var a=r.toDataURL("image/png");e.style.cursor="url("+a+") "+o/2+" "+o/2+",auto"}function d(e,t,n){e.beginPath(),e.arc(t/2,t/2,t/2,0,2*Math.PI,!1),e.fillStyle=n,e.fill()}function u(e,t){e.fillStyle="#da502d",e.fillRect(0,0,2*t/3,t),e.fillStyle="#6584a5",e.fillRect(2*t/3-1,0,t,t),e.globalCompositeOperation="destination-in",d(e,t,"white")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){f.style.border="1px solid "+o(v,c.style.backgroundColor)}function r(e){v=e,a(l,m,v),"eraser"==e?(f.style.background="",f.classList.add("eraser")):(f.classList.remove("eraser"),f.style.background=e,localStorage.setItem("color",e),n()),u(e)}function d(e){m=e,a(l,m,v),f.style.transform="scale("+e/10+")"}var u=t.onColorChange,c=t.elementToContrastWith,l=t.canvasForCursor,f=e.children[0],v=void 0;e.addEventListener("click",function(){return i(v,r)});var m=void 0;return setTimeout(function(){return r(localStorage.getItem("color")||s)}),{setColorDotSize:d,refreshColorPreviewBorder:n}};var c=n(0),l=n(6),s="#2b76ce"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.paletteColors="#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B".split(",")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(e){(0,o.startTask)();var t=new FileReader;t.onload=function(){n(t.result),(0,o.endTask)()},t.onerror=o.endTask,t.readAsDataURL(e)}function n(e){if((0,o.startTask)(),u){var t=new Image;t.onload=function(){u=!1,i(t,d),(0,o.endTask)()},t.onerror=o.endTask,t.src=e}}function r(e){var o=Array.prototype.find.call(e,function(e){return"file"==e.kind&&e.type.match("image")});if(d="pasted-image",o)return void t(o.getAsFile());var r=Array.prototype.find.call(e,function(e){return"string"==e.kind});r&&r.getAsString(function(e){return n(e)})}var i=e.onImageCreated,a=e.fileinput,d="pasted-image",u=!0;!function(){function e(n){a.removeEventListener("change",e),d=a.value.split("\\").pop().split(".")[0]||"image",t(n.target.files[0])}a.addEventListener("change",e)}(),window.addEventListener("paste",function(e){r(e.clipboardData.items)}),document.body.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),document.body.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation(),r(e.dataTransfer.items)})};var o=n(8)},function(e,t,n){"use strict";function o(){a++,i()}function r(){a--,setTimeout(i)}function i(){spinners.classList[a?"remove":"add"]("hidden")}Object.defineProperty(t,"__esModule",{value:!0}),t.startTask=o,t.endTask=r,t.updateLook=i;var a=0;document.addEventListener("DOMContentLoaded",i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){a++,localStorage.setItem("background",a),o()}function o(){var t=["#DDD","#333"],n=a%t.length;e.style.backgroundColor=t[n],r(n);var o=document.body.classList;t.forEach(function(e,t){return o.remove("background_n_"+t)}),o.add("background_n_"+n),i<8?(console.log(0==n?"jour !":"nuit !"),i++):console.log("Monsieur Jacquouille, je vous en prie, à la longue, ça devient casse-pied !")}var r=t.onChange,i=0,a=localStorage.getItem("background")||0;o(),e.addEventListener("click",n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(){m=e.getBoundingClientRect(),v=m.width/e.width,g&&p&&(p.lineWidth=g/v)}function r(e){return{x:(e.clientX-m.left)/v,y:(e.clientY-m.top)/v}}function i(){y||(y=!0,p.beginPath(),d())}function a(){y&&s(),y=!1}function d(){y&&(window.requestAnimationFrame(d),u())}function u(){p.moveTo(w.x,w.y),p.lineTo(h.x,h.y),p.stroke(),w=h}function c(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;e.addEventListener(t,function(e){e.preventDefault();var t=e.touches[0]||{},r=t.clientX,i=t.clientY,a=new MouseEvent(n,{clientX:r,clientY:i});o.dispatchEvent(a)},!1)}var l=t.onMouseDown,s=t.onMouseUp,f=t.OrginalImage,v=void 0,m=void 0,g=void 0;n(),window.addEventListener("resize",n);var p=e.getContext("2d");p.lineCap="round";var h={x:0,y:0},w=h;e.addEventListener("mousedown",function(t){if(3==t.which)return void(0,o.mergeCanvasAndImage)(e,f);h=w=r(t),i(),l()},!1),document.addEventListener("copy",function(t){t.preventDefault(),(0,o.mergeCanvasAndImage)(e,f),t.clipboardData.setData("text/html",'<img src="'+e.toDataURL()+'"/>')}),document.addEventListener("mouseup",a,!1),e.addEventListener("mousemove",function(e){h=r(e)},!1);var y=!1;return c("touchstart","mousedown"),c("touchend","mouseup",document),c("touchmove","mousemove"),{drawWithEraser:function(){p.globalCompositeOperation="destination-out"},drawWithColor:function(e){p.globalCompositeOperation="source-over",p.strokeStyle=e},setPencilSize:function(e){g=e,p.lineWidth=e/v}}};var o=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){function n(t){e.value=t,localStorage.setItem("pensize",t),o(t)}var o=t.onChange;e.addEventListener("input",function(e){return n(e.target.value)}),n(parseInt(localStorage.getItem("pensize"))||DEFAULTSIZE)}},function(e,t,n){"use strict";function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=e.filter(function(e){return e!=t});return n[Math.floor(Math.random()*(n.length+.99))]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){function t(){s=e.width=window.innerWidth,f=e.height=window.innerHeight,l=e.getContext("2d"),l.fillStyle=v,l.fillRect(0,0,s,f),l.lineCap="round",n()}function n(){m={x:s/2,y:f/2},g={x:10*Math.random()-5,y:10*Math.random()-5},p={x:10*Math.random()-5,y:10*Math.random()-5},l.strokeStyle=o(i,v),l.lineWidth=20+40*Math.random(),l.beginPath(),l.moveTo(m.x,m.y)}function r(){p={x:2*Math.random()-1,y:2*Math.random()-1},h=setTimeout(r,100+200*Math.random())}function d(){l.moveTo(m.x,m.y),g.x*=.95,g.y*=.95,g.x+=p.x,g.y+=p.y,m.x+=g.x,m.y+=g.y,l.lineTo(m.x,m.y),l.stroke(),(m.x<-50||m.x>s+50||m.y<-50||m.y>f+50)&&n()}function u(){w&&(window.requestAnimationFrame(u),d())}function c(){w=!1,clearTimeout(h),window.removeEventListener("resize",t)}var l=void 0,s=void 0,f=void 0,v=o(a),m=void 0,g=void 0,p=void 0,h=void 0;t(),window.addEventListener("resize",t),r();var w=!0;return u(),{stopAnim:c,bgColor:v}};var r=n(0),i="#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722".split(","),a=i.filter(function(e){return(0,r.luminance)(e)<150})},function(e,t,n){"use strict";function o(){if(navigator.userAgent.match(/Android/i)){var e=document.createElement("script");e.src="https://iswebview.herokuapp.com/?callback=JSONPcallback",document.body.appendChild(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.checkRunWithinWebview=o,window.JSONPcallback=function(e){e.isWebView&&(document.body.classList.add("runningWithinWebview"),document.body.innerHTML='\n      Please open minimage.tk with chrome,\n       it cannot work within another app.\n\n        There may be an option in the menu above the page,\n         something like "Open in Chrome".\n\n         ')}}]);
//# sourceMappingURL=bundle.js.map