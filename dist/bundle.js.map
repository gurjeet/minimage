{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 9db91a42925e541f732a","webpack:///./src/app.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_toConsumableArray","arr","Array","isArray","arr2","length","from","handleDataTransferItems","items","imageFile","find","e","kind","type","match","originalFileName","console","log","loadFile","getAsFile","url","getAsString","createImageWithFileContent","askForImage","fileChanged","changeEvent","fileinput","removeEventListener","value","split","pop","target","files","byId","addEventListener","fileToLoad","innerHTML","fileReader","FileReader","onload","result","readAsDataURL","askingForImage","img","Image","letUserDrawAndDownload","src","measureScale","rect","canvas","getBoundingClientRect","scale","width","setColor","color","currentColor","ctx","globalCompositeOperation","pensizePreviewDot","style","background","classList","add","remove","strokeStyle","localStorage","setItem","refreshColorPreviewBorder","border","borderColor","backgroundColor","setPencilSize","pxSize","transform","lineWidth","pensize","getMousePos","mouseEvent","x","clientX","left","y","clientY","top","startDrawLoop","isDrawing","beginPath","drawLoop","endDrawLoop","window","requestAnimationFrame","renderCanvas","moveTo","lastPos","lineTo","mousePos","stroke","proxyTouchToMouse","touchEventName","mouseEventName","eventTarget","arguments","undefined","preventDefault","_ref","touches","MouseEvent","dispatchEvent","downloadImage","filename","downloadCounter","this","href","mergeCanvasAndImage","OrginalImage","toDataURL","download","switchBackground","currentMode","applyBackground","options","appendChild","display","maxRes","Math","max","innerHeight","innerWidth","imgScale","height","maxWidth","maxHeight","getContext","pensizePreview","getItem","DEFAULTCOLOR","openColorPicker","parseInt","DEFAULTSIZE","lineCap","document","colorToRGBA","createElement","clearRect","fillStyle","fillRect","concat","getImageData","data","luminance","slice","reduce","a","b","foreground","bgL","fgL","callback","pickColor","closeModal","body","removeChild","modal","paletteColors","forEach","button","toLowerCase","eraser","clone","drawImage","ev","clipboardData","stopPropagation","dataTransfer","getElementById","bind"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(1);\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(2);\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } } /*\n                                                                                                                                                                                                    \n                                                                                                                                                                                                    See the app in action here : https://minimage.tk\n                                                                                                                                                                                                    \n                                                                                                                                                                                                    */\n\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  askForImage();\n});\n\nwindow.addEventListener('paste', function (ev) {\n  handleDataTransferItems(ev.clipboardData.items);\n});\n\ndocument.body.addEventListener('dragover', function (ev) {\n  ev.preventDefault();\n  ev.stopPropagation();\n});\ndocument.body.addEventListener('drop', function (ev) {\n  ev.preventDefault();\n  ev.stopPropagation();\n  handleDataTransferItems(ev.dataTransfer.items);\n});\n\nfunction handleDataTransferItems(items) {\n  // Tries to paste an image\n  var imageFile = Array.prototype.find.call(items, function (e) {\n    return e.kind == 'file' && e.type.match('image');\n  });\n  originalFileName = 'pasted-image';\n  if (imageFile) {\n    console.log('parsing pasted image content');\n    loadFile(imageFile.getAsFile());\n    return;\n  }\n  // Tries to load a remote image given its adress\n  var url = Array.prototype.find.call(items, function (e) {\n    return e.kind == 'string';\n  });\n  if (url) {\n    console.log('parsing url content');\n    url.getAsString(function (s) {\n      return createImageWithFileContent(s);\n    });\n  }\n}\n\nvar byId = document.getElementById.bind(document),\n    DEFAULTCOLOR = '#2b76ce',\n    DEFAULTSIZE = 20;\n\nvar originalFileName = 'pasted-image';\nvar askingForImage = true;\n// Setup of the welcome  UI\nfunction askForImage() {\n  var fileinput = byId('fileinput');\n  fileinput.addEventListener('change', fileChanged);\n  function fileChanged(changeEvent) {\n    fileinput.removeEventListener('change', fileChanged);\n    // go to next step\n\n    originalFileName = fileinput.value.split('\\\\').pop().split('.')[0] || 'image';\n    loadFile(changeEvent.target.files[0]);\n  }\n}\n\n// Transforms the file input content to a real image\nfunction loadFile(fileToLoad) {\n  byId('readme').innerHTML = '<h1>Loading ...</h1>';\n\n  var fileReader = new FileReader();\n  fileReader.onload = function () {\n    return createImageWithFileContent(fileReader.result);\n  };\n  fileReader.readAsDataURL(fileToLoad);\n}\n\nfunction createImageWithFileContent(result) {\n  console.log('trying to load file as image');\n  if (!askingForImage) return;\n  var img = new Image();\n  img.onload = function () {\n    return letUserDrawAndDownload(img);\n  };\n  img.src = result;\n}\n\nvar OrginalImage = void 0;\n// Lets the user draw on the loaded image\nfunction letUserDrawAndDownload(img) {\n  askingForImage = false;\n  OrginalImage = img;\n  var canvas = byId('drawzone'),\n      drawzoneWrapper = byId('drawzoneWrapper');\n  drawzoneWrapper.appendChild(img);\n  // Switch to drawing mode\n  byId('inputForAFile').style.display = 'none';\n  byId('drawAndDownload').style.display = '';\n\n  // Fits the canvas to screen\n  var maxRes = Math.max(window.innerHeight, window.innerWidth);\n  var imgScale = Math.max(img.width / maxRes, img.height / maxRes, 1);\n  img.style.maxWidth = canvas.width = img.width / imgScale;\n  img.style.maxHeight = canvas.height = img.height / imgScale;\n\n  // Display the loaded image on the canvas\n  var ctx = canvas.getContext('2d');\n  // ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n  // We cache some zoom related data to avoid getting them all the time\n  var scale = void 0,\n      rect = void 0;\n  function measureScale() {\n    rect = canvas.getBoundingClientRect();\n    scale = rect.width / canvas.width;\n  }\n  measureScale();\n  window.addEventListener('resize', measureScale);\n\n  var pensizePreview = byId('pensizePreview'),\n      pensizePreviewDot = byId('pensizePreviewDot'),\n      pensize = byId('pensize');\n\n  var currentColor = '';\n  // Sets draw color at load and when user clicks color input\n  function setColor(color) {\n\n    currentColor = color;\n    if (color == 'eraser') {\n      ctx.globalCompositeOperation = 'destination-out';\n      pensizePreviewDot.style.background = '';\n      pensizePreviewDot.classList.add('eraser');\n    } else {\n      pensizePreviewDot.classList.remove('eraser');\n      ctx.globalCompositeOperation = 'source-over';\n      pensizePreviewDot.style.background = ctx.strokeStyle = color;\n      localStorage.setItem('color', color);\n      refreshColorPreviewBorder();\n    }\n  }\n  function refreshColorPreviewBorder() {\n    var pensizePreviewDot = byId('pensizePreviewDot');\n    pensizePreviewDot.style.border = '1px solid ' + borderColor(pensizePreviewDot.style.backgroundColor, byId('background').style.backgroundColor);\n  }\n  setColor(localStorage.getItem('color') || DEFAULTCOLOR);\n\n  pensizePreview.addEventListener('click', function () {\n    return openColorPicker(currentColor, setColor);\n  });\n\n  // Sets draw size at load and stylewhen the user interracts with the slider\n  function setPencilSize(pxSize) {\n\n    pensizePreviewDot.style.transform = 'scale(' + pxSize / 10 + ')';\n    ctx.lineWidth = pxSize / scale;\n    pensize.value = pxSize;\n    localStorage.setItem('pensize', pxSize);\n  }\n  pensize.addEventListener('input', function (e) {\n    return setPencilSize(e.target.value);\n  });\n  setPencilSize(parseInt(localStorage.getItem('pensize')) || DEFAULTSIZE);\n\n  // To make the lines look slightly nicer\n  ctx.lineCap = 'round';\n\n  // We cache the mouse position and previous mouse position.\n  // Theay are defined by touch events, and used by the draw loop\n  var mousePos = {\n    x: 0,\n    y: 0\n  },\n      lastPos = mousePos;\n\n  canvas.addEventListener('mousedown', function (e) {\n    mousePos = lastPos = getMousePos(e);\n    startDrawLoop();\n  }, false);\n\n  document.addEventListener('mouseup', endDrawLoop, false);\n\n  canvas.addEventListener('mousemove', function (e) {\n    mousePos = getMousePos(e);\n  }, false);\n\n  // Get the position of the mouse relative to the canvas\n  function getMousePos(mouseEvent) {\n    return {\n      x: (mouseEvent.clientX - rect.left) / scale,\n      y: (mouseEvent.clientY - rect.top) / scale\n    };\n  }\n\n  // Drawing loop is separated from the events￼\n\n  var isDrawing = false;\n\n  function startDrawLoop() {\n    if (isDrawing) return;\n    isDrawing = true;\n    ctx.beginPath();\n    drawLoop();\n  }\n  function endDrawLoop() {\n    isDrawing = false;\n  }\n\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n  function renderCanvas() {\n    console.log('rendering');\n    ctx.moveTo(lastPos.x, lastPos.y);\n    ctx.lineTo(mousePos.x, mousePos.y);\n    ctx.stroke();\n    lastPos = mousePos;\n  }\n\n  // Proxy mobile events to their mouse counterpart\n  function proxyTouchToMouse(touchEventName, mouseEventName) {\n    var eventTarget = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : canvas;\n\n    canvas.addEventListener(touchEventName, function (e) {\n      e.preventDefault();\n\n      var _ref = e.touches[0] || {},\n          clientX = _ref.clientX,\n          clientY = _ref.clientY;\n\n      var mouseEvent = new MouseEvent(mouseEventName, {\n        clientX: clientX,\n        clientY: clientY\n      });\n      eventTarget.dispatchEvent(mouseEvent);\n    }, false);\n  }\n  proxyTouchToMouse('touchstart', 'mousedown');\n  proxyTouchToMouse('touchend', 'mouseup', document);\n  proxyTouchToMouse('touchmove', 'mousemove');\n\n  // Download button\n  var downloadCounter = 0;\n  byId('download').addEventListener('click', downloadImage, false);\n  function downloadImage(e) {\n    var filename = originalFileName + '-minimage-' + downloadCounter + '.png';\n    this.href = mergeCanvasAndImage(canvas, OrginalImage).toDataURL('image/png', 0.5);\n    this.download = filename;\n    downloadCounter++;\n  }\n\n  // Tap the background to switch its color (usefull for transparent images)\n  var background = byId('background');\n  function switchBackground() {\n    currentMode++;\n    localStorage.setItem('background', currentMode);\n    applyBackground();\n  }\n  function applyBackground() {\n    var options = ['#FFF', '#333'];\n    background.style.backgroundColor = options[currentMode % options.length];\n    refreshColorPreviewBorder();\n  }\n  var currentMode = localStorage.getItem('background') || 0;\n  applyBackground();\n  background.addEventListener('click', switchBackground);\n}\n\nfunction colorToRGBA(color) {\n  var canvas = document.createElement('canvas');\n  canvas.width = canvas.height = 1;\n  var ctx = canvas.getContext('2d');\n  ctx.clearRect(0, 0, 1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return [].concat(_toConsumableArray(ctx.getImageData(0, 0, 1, 1).data));\n}\nfunction luminance(color) {\n  return colorToRGBA(color).slice(0, 3).reduce(function (a, b) {\n    return a + b;\n  }, 0) / 3;\n  pickColor;\n}\n\nfunction borderColor(foreground, background) {\n  var bgL = luminance(background);\n  var fgL = luminance(foreground);\n  if (bgL > 125 && fgL > 200) return 'black';\n  if (bgL < 125 && fgL < 25) return 'white';\n  return 'transparent';\n}\n\nvar paletteColors = '#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B'.split(',');\n\nfunction openColorPicker(currentColor, callback) {\n  var modal = document.createElement('div');\n  modal.classList.add('modal');\n  document.body.appendChild(modal);\n\n  function pickColor(color) {\n    closeModal();\n    callback(color);\n  }\n\n  paletteColors.forEach(function (color) {\n    var button = document.createElement('button');\n    button.classList.add('colorbutton');\n    if (color === currentColor) {\n      button.classList.add('active');\n      button.innerHTML = 'Your selected color';\n    }\n    button.style.backgroundColor = color.toLowerCase();\n    button.addEventListener('click', function () {\n      return pickColor(color);\n    });\n    modal.appendChild(button);\n  });\n\n  var eraser = document.createElement('button');\n  eraser.classList.add('eraser');\n  eraser.addEventListener('click', function () {\n    return pickColor('eraser');\n  });\n  eraser.innerHTML = '<img src=\"/images/eraser.svg\"/>Eraser (reveals photo)';\n  modal.appendChild(eraser);\n\n  function closeModal() {\n    document.body.removeChild(modal);\n  }\n}\n\nfunction mergeCanvasAndImage(canvas, img) {\n  var clone = document.createElement('canvas');\n  clone.width = canvas.width;\n  clone.height = canvas.height;\n  var ctx = clone.getContext('2d');\n  // Draw the orignal image\n  ctx.drawImage(img, 0, 0, clone.width, clone.height);\n  // And then the user's mess on top\n  ctx.drawImage(canvas, 0, 0);\n  return clone;\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9db91a42925e541f732a","/*\n\nSee the app in action here : https://minimage.tk\n\n*/\nimport './styles.less';\n\ndocument.addEventListener('DOMContentLoaded', function() {\n  askForImage();\n});\n\nwindow.addEventListener('paste', function(ev) {\n  handleDataTransferItems(ev.clipboardData.items);\n});\n\ndocument.body.addEventListener('dragover', function(ev) {\n  ev.preventDefault();\n  ev.stopPropagation();\n});\ndocument.body.addEventListener('drop', function(ev) {\n  ev.preventDefault();\n  ev.stopPropagation();\n  handleDataTransferItems(ev.dataTransfer.items);\n});\n\nfunction handleDataTransferItems(items) {\n  // Tries to paste an image\n  let imageFile = Array.prototype.find.call(\n    items,\n    e => e.kind == 'file' && e.type.match('image')\n  );\n  originalFileName = 'pasted-image';\n  if (imageFile) {\n    console.log('parsing pasted image content');\n    loadFile(imageFile.getAsFile());\n    return;\n  }\n  // Tries to load a remote image given its adress\n  let url = Array.prototype.find.call(items, e => e.kind == 'string');\n  if (url) {\n    console.log('parsing url content');\n    url.getAsString(s => createImageWithFileContent(s));\n  }\n}\n\nconst byId = document.getElementById.bind(document),\n  DEFAULTCOLOR = '#2b76ce',\n  DEFAULTSIZE = 20;\n\nvar originalFileName = 'pasted-image';\nlet askingForImage = true;\n// Setup of the welcome  UI\nfunction askForImage() {\n  let fileinput = byId('fileinput');\n  fileinput.addEventListener('change', fileChanged);\n  function fileChanged(changeEvent) {\n    fileinput.removeEventListener('change', fileChanged);\n    // go to next step\n\n    originalFileName =\n      fileinput.value.split('\\\\').pop().split('.')[0] || 'image';\n    loadFile(changeEvent.target.files[0]);\n  }\n}\n\n// Transforms the file input content to a real image\nfunction loadFile(fileToLoad) {\n  byId('readme').innerHTML = '<h1>Loading ...</h1>';\n\n  let fileReader = new FileReader();\n  fileReader.onload = () => createImageWithFileContent(fileReader.result);\n  fileReader.readAsDataURL(fileToLoad);\n}\n\nfunction createImageWithFileContent(result) {\n  console.log('trying to load file as image');\n  if (!askingForImage) return;\n  let img = new Image();\n  img.onload = () => letUserDrawAndDownload(img);\n  img.src = result;\n}\n\nlet OrginalImage;\n// Lets the user draw on the loaded image\nfunction letUserDrawAndDownload(img) {\n  askingForImage = false;\n  OrginalImage = img;\n  const canvas = byId('drawzone'),\n    drawzoneWrapper = byId('drawzoneWrapper');\n  drawzoneWrapper.appendChild(img);\n  // Switch to drawing mode\n  byId('inputForAFile').style.display = 'none';\n  byId('drawAndDownload').style.display = '';\n\n  // Fits the canvas to screen\n  let maxRes = Math.max(window.innerHeight, window.innerWidth);\n  let imgScale = Math.max(img.width / maxRes, img.height / maxRes, 1);\n  img.style.maxWidth = canvas.width = img.width / imgScale;\n  img.style.maxHeight = canvas.height = img.height / imgScale;\n\n  // Display the loaded image on the canvas\n  let ctx = canvas.getContext('2d');\n  // ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n  // We cache some zoom related data to avoid getting them all the time\n  let scale, rect;\n  function measureScale() {\n    rect = canvas.getBoundingClientRect();\n    scale = rect.width / canvas.width;\n  }\n  measureScale();\n  window.addEventListener('resize', measureScale);\n\n  const pensizePreview = byId('pensizePreview'),\n    pensizePreviewDot = byId('pensizePreviewDot'),\n    pensize = byId('pensize');\n\n  let currentColor = '';\n  // Sets draw color at load and when user clicks color input\n  function setColor(color) {\n\n\n\n\n    currentColor = color;\n    if (color == 'eraser') {\n      ctx.globalCompositeOperation = 'destination-out';\n      pensizePreviewDot.style.background = '';\n      pensizePreviewDot.classList.add('eraser');\n    } else {\n      pensizePreviewDot.classList.remove('eraser');\n      ctx.globalCompositeOperation = 'source-over';\n      pensizePreviewDot.style.background = ctx.strokeStyle = color;\n      localStorage.setItem('color', color);\n      refreshColorPreviewBorder();\n    }\n  }\n  function refreshColorPreviewBorder() {\n    let pensizePreviewDot = byId('pensizePreviewDot');\n    pensizePreviewDot.style.border =\n      '1px solid ' +\n      borderColor(\n        pensizePreviewDot.style.backgroundColor,\n        byId('background').style.backgroundColor\n      );\n  }\n  setColor(localStorage.getItem('color') || DEFAULTCOLOR);\n\n  pensizePreview.addEventListener('click', () =>\n    openColorPicker(currentColor, setColor)\n  );\n\n  // Sets draw size at load and stylewhen the user interracts with the slider\n  function setPencilSize(pxSize) {\n\n\n\n    pensizePreviewDot.style.transform = 'scale(' + pxSize / 10 + ')';\n    ctx.lineWidth = pxSize / scale;\n    pensize.value = pxSize;\n    localStorage.setItem('pensize', pxSize);\n  }\n  pensize.addEventListener('input', e => setPencilSize(e.target.value));\n  setPencilSize(parseInt(localStorage.getItem('pensize')) || DEFAULTSIZE);\n\n  // To make the lines look slightly nicer\n  ctx.lineCap = 'round';\n\n  // We cache the mouse position and previous mouse position.\n  // Theay are defined by touch events, and used by the draw loop\n  let mousePos = {\n      x: 0,\n      y: 0\n    },\n    lastPos = mousePos;\n\n  canvas.addEventListener(\n    'mousedown',\n    function(e) {\n      mousePos = lastPos = getMousePos(e);\n      startDrawLoop();\n    },\n    false\n  );\n\n  document.addEventListener('mouseup', endDrawLoop, false);\n\n  canvas.addEventListener(\n    'mousemove',\n    function(e) {\n      mousePos = getMousePos(e);\n    },\n    false\n  );\n\n  // Get the position of the mouse relative to the canvas\n  function getMousePos(mouseEvent) {\n    return {\n      x: (mouseEvent.clientX - rect.left) / scale,\n      y: (mouseEvent.clientY - rect.top) / scale\n    };\n  }\n\n  // Drawing loop is separated from the events￼\n\n  let isDrawing = false;\n\n  function startDrawLoop() {\n    if (isDrawing) return;\n    isDrawing = true;\n    ctx.beginPath();\n    drawLoop();\n  }\n  function endDrawLoop() {\n    isDrawing = false;\n\n  }\n\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n  function renderCanvas() {\n    console.log('rendering')\n    ctx.moveTo(lastPos.x, lastPos.y);\n    ctx.lineTo(mousePos.x, mousePos.y);\n    ctx.stroke();\n    lastPos = mousePos;\n  }\n\n  // Proxy mobile events to their mouse counterpart\n  function proxyTouchToMouse(touchEventName, mouseEventName, eventTarget=canvas) {\n    canvas.addEventListener(\n      touchEventName,\n      function(e) {\n        e.preventDefault();\n        let { clientX, clientY } = e.touches[0] || {};\n        let mouseEvent = new MouseEvent(mouseEventName, {\n          clientX,\n          clientY\n        });\n        eventTarget.dispatchEvent(mouseEvent);\n      },\n      false\n    );\n  }\n  proxyTouchToMouse('touchstart', 'mousedown');\n  proxyTouchToMouse('touchend', 'mouseup', document);\n  proxyTouchToMouse('touchmove', 'mousemove');\n\n  // Download button\n  var downloadCounter = 0;\n  byId('download').addEventListener('click', downloadImage, false);\n  function downloadImage(e) {\n    let filename = originalFileName + '-minimage-' + downloadCounter + '.png';\n    this.href = mergeCanvasAndImage(canvas, OrginalImage).toDataURL(\n      'image/png',\n      0.5\n    );\n    this.download = filename;\n    downloadCounter++;\n  }\n\n  // Tap the background to switch its color (usefull for transparent images)\n  let background = byId('background');\n  function switchBackground() {\n    currentMode++;\n    localStorage.setItem('background', currentMode);\n    applyBackground();\n  }\n  function applyBackground() {\n    let options = ['#FFF', '#333'];\n    background.style.backgroundColor = options[currentMode % options.length];\n    refreshColorPreviewBorder();\n  }\n  let currentMode = localStorage.getItem('background') || 0;\n  applyBackground();\n  background.addEventListener('click', switchBackground);\n}\n\nfunction colorToRGBA(color) {\n  var canvas = document.createElement('canvas');\n  canvas.width = canvas.height = 1;\n  var ctx = canvas.getContext('2d');\n  ctx.clearRect(0, 0, 1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return [...ctx.getImageData(0, 0, 1, 1).data];\n}\nfunction luminance(color) {\n  return colorToRGBA(color).slice(0, 3).reduce((a, b) => a + b, 0) / 3;\n  pickColor;\n}\n\nfunction borderColor(foreground, background) {\n  let bgL = luminance(background);\n  let fgL = luminance(foreground);\n  if (bgL > 125 && fgL > 200) return 'black';\n  if (bgL < 125 && fgL < 25) return 'white';\n  return 'transparent';\n}\n\nlet paletteColors = '#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B'.split(\n  ','\n);\n\nfunction openColorPicker(currentColor, callback) {\n  let modal = document.createElement('div');\n  modal.classList.add('modal');\n  document.body.appendChild(modal);\n\n  function pickColor(color) {\n    closeModal();\n    callback(color);\n  }\n\n  paletteColors.forEach(color => {\n    let button = document.createElement('button');\n    button.classList.add('colorbutton');\n    if (color === currentColor){\n      button.classList.add('active');\n      button.innerHTML='Your selected color'\n    }\n    button.style.backgroundColor = color.toLowerCase();\n    button.addEventListener('click', () => pickColor(color));\n    modal.appendChild(button);\n  });\n\n  let eraser = document.createElement('button');\n  eraser.classList.add('eraser');\n  eraser.addEventListener('click', () => pickColor('eraser'));\n  eraser.innerHTML = '<img src=\"/images/eraser.svg\"/>Eraser (reveals photo)';\n  modal.appendChild(eraser);\n\n  function closeModal() {\n    document.body.removeChild(modal);\n  }\n}\n\nfunction mergeCanvasAndImage(canvas, img) {\n  let clone = document.createElement('canvas');\n  clone.width = canvas.width;\n  clone.height = canvas.height;\n  var ctx = clone.getContext('2d');\n  // Draw the orignal image\n  ctx.drawImage(img, 0, 0, clone.width, clone.height);\n  // And then the user's mess on top\n  ctx.drawImage(canvas, 0, 0);\n  return clone;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js"],"sourceRoot":""}