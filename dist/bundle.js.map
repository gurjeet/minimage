{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap ff0baf3075c4e74db0d4","webpack:///./src/colorToRGB.js","webpack:///./src/welcomeAnim.js","webpack:///./src/canvasMergerAndDonwloaderLink.js","webpack:///./src/app.js","webpack:///./src/colorPicker.js","webpack:///./src/palette.js","webpack:///./src/getAnImage.js","webpack:///./src/toggleAbleBackground.js","webpack:///./src/editableCanvas.js","webpack:///./src/pencilSizeSlider.js","webpack:///./src/checkRunWithinWebview.js","webpack:///./src/spinners.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_toConsumableArray","arr","Array","isArray","arr2","length","from","colorToRGB","color","canvas","document","createElement","width","height","ctx","getContext","clearRect","fillStyle","fillRect","concat","getImageData","data","slice","luminance","reduce","a","b","value","randomColor","colorPool","exception","arguments","undefined","withoutEx","filter","Math","floor","random","default","_ref","reset","fitWindow","window","innerWidth","innerHeight","w","h","bgColor","lineCap","randomizeInst","position","x","y","speed","acceleration","strokeStyle","coolColors","lineWidth","beginPath","moveTo","randomAcceletation","accelerationTimeoutHandle","setTimeout","renderCanvas","lineTo","stroke","drawLoop","isDrawing","requestAnimationFrame","stopAnim","clearTimeout","removeEventListener","darkCoolColors","addEventListener","_colorToRGB","split","makeDownloadLink","link","downloadImage","e","startTask","preventDefault","filename","originalFileName","downloadCounter","mergeCanvasAndImage","OrginalImage","downloadCanvas","endTask","callback","toBlob","blob","navigator","msSaveOrOpenBlob","msSaveBlob","url","URL","createObjectURL","body","appendChild","setAttribute","click","revokeObjectURL","removeChild","img","oldComposite","globalCompositeOperation","drawImage","_interopRequireDefault","obj","letUserDrawAndDownload","setColor","drawWithEraser","drawWithColor","byId","drawzoneWrapper","style","display","console","log","imgScale","max","maxWidth","maxHeight","hasDoneFirstDraw","barClass","classList","background","_setupColorPicker","_colorPicker2","canvasForCursor","onColorChange","elementToContrastWith","setColorDotSize","refreshColorPreviewBorder","_setupEditableCanvas","_editableCanvas2","onMouseDown","getClientRects","add","onMouseUp","download","remove","setPencilSize","_toggleAbleBackground2","onChange","_pencilSizeSlider2","pxSize","_canvasMergerAndDonwloaderLink","_colorPicker","_getAnImage","_getAnImage2","_toggleAbleBackground","_editableCanvas","_pencilSizeSlider","_welcomeAnim2","_welcomeAnim3","_checkRunWithinWebview","_spinners","getElementById","bind","checkRunWithinWebview","fileinput","onImageCreated","_welcomeAnim","borderColor","foreground","bgL","fgL","textColor","openColorPicker","currentColor","pickColor","closeModal","modal","_palette","paletteColors","forEach","button","innerHTML","backgroundColor","toLowerCase","eraser","setCursor","node","size","drawEraser","drawColorCircle","cursor","toDataURL","arc","PI","fill","pensizePreview","pensizePreviewDot","border","onColorPicked","currentSize","localStorage","setItem","transform","children","getItem","DEFAULTCOLOR","loadFile","fileToLoad","fileReader","FileReader","onload","createImageWithFileContent","result","onerror","readAsDataURL","askingForImage","Image","src","handleDataTransferItems","items","imageFile","find","kind","type","match","getAsFile","getAsString","_ref$startTask","_ref$endTask","fileChanged","changeEvent","pop","target","files","ev","clipboardData","stopPropagation","dataTransfer","switchBackground","currentMode","applyBackground","options","current","bclass","index","switchCount","measureScale","rect","getBoundingClientRect","scale","lastUsedPXsize","getMousePos","mouseEvent","clientX","left","clientY","top","startDrawLoop","endDrawLoop","lastPos","mousePos","proxyTouchToMouse","touchEventName","mouseEventName","eventTarget","_ref2","touches","MouseEvent","dispatchEvent","which","setData","slider","onPencilSizeChange","parseInt","DEFAULTSIZE","userAgent","JSONPcall","JSONPcallback","isWebView","tasksInProgress","updateLook","spinners"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.colorToRGB = colorToRGB;\nexports.luminance = luminance;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction colorToRGB(color) {\n  var canvas = document.createElement(\"canvas\");\n  canvas.width = canvas.height = 1;\n  var ctx = canvas.getContext(\"2d\");\n  ctx.clearRect(0, 0, 1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return [].concat(_toConsumableArray(ctx.getImageData(0, 0, 1, 1).data)).slice(0, 3);\n}\n\nfunction luminance(color) {\n  return colorToRGB(color).reduce(function (a, b) {\n    return a + b;\n  }, 0) / 3;\n}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (canvas, _ref) {\n  var fitWindow = _ref.fitWindow;\n\n  var ctx = void 0,\n      w = void 0,\n      h = void 0;\n  var bgColor = randomColor(darkCoolColors);\n  function reset() {\n    if (fitWindow) {\n      canvas.width = window.innerWidth;\n      canvas.height = window.innerHeight;\n    }\n    w = canvas.width;\n    h = canvas.height;\n    ctx = canvas.getContext(\"2d\");\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, w, h);\n    ctx.lineCap = \"round\";\n    randomizeInst();\n  }\n\n  var position = void 0,\n      speed = void 0,\n      acceleration = void 0,\n      timeoutHandle = void 0,\n      accelerationTimeoutHandle = void 0;\n  function randomizeInst() {\n    position = {\n      // x: Math.random() * w,\n      // y: Math.random() * h\n      x: w / 2,\n      y: h / 2\n    };\n    speed = {\n      x: Math.random() * 10 - 5,\n      y: Math.random() * 10 - 5\n    };\n    acceleration = {\n      x: Math.random() * 10 - 5,\n      y: Math.random() * 10 - 5\n    };\n\n    ctx.strokeStyle = randomColor(coolColors, bgColor);\n    ctx.lineWidth = 20 + Math.random() * 40;\n    ctx.beginPath();\n    ctx.moveTo(position.x, position.y);\n  }\n\n  reset();\n  window.addEventListener(\"resize\", reset);\n\n  function randomAcceletation() {\n    acceleration = {\n      x: Math.random() * 2 - 1,\n      y: Math.random() * 2 - 1\n    };\n    // speed.x*=0.2;\n    // speed.y*=0.2;\n\n    accelerationTimeoutHandle = setTimeout(randomAcceletation, 100 + Math.random() * 200);\n  }\n  randomAcceletation();\n  function renderCanvas() {\n    ctx.moveTo(position.x, position.y);\n    speed.x *= 0.95;\n    speed.y *= 0.95;\n\n    speed.x += acceleration.x;\n    speed.y += acceleration.y;\n    position.x += speed.x;\n    position.y += speed.y;\n    ctx.lineTo(position.x, position.y);\n    ctx.stroke();\n    if (position.x < -50 || position.x > w + 50 || position.y < -50 || position.y > h + 50) randomizeInst();\n  }\n\n  var isDrawing = true;\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n\n  drawLoop();\n\n  function stopAnim() {\n    isDrawing = false;\n    clearTimeout(accelerationTimeoutHandle);\n    window.removeEventListener(\"resize\", reset);\n  }\n\n  return {\n    stopAnim: stopAnim,\n    bgColor: bgColor\n  };\n};\n\nvar _colorToRGB = __webpack_require__(0);\n\nvar coolColors = \"#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722\".split(\",\");\nvar darkCoolColors = coolColors.filter(function (c) {\n  return (0, _colorToRGB.luminance)(c) < 150;\n});\n\nfunction randomColor(colorPool) {\n  var exception = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\n  var withoutEx = colorPool.filter(function (c) {\n    return c != exception;\n  });\n  return withoutEx[Math.floor(Math.random() * (withoutEx.length + 0.99))];\n}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.makeDownloadLink = makeDownloadLink;\nexports.mergeCanvasAndImage = mergeCanvasAndImage;\nfunction makeDownloadLink(link, _ref) {\n  var OrginalImage = _ref.OrginalImage,\n      canvas = _ref.canvas,\n      originalFileName = _ref.originalFileName,\n      startTask = _ref.startTask,\n      endTask = _ref.endTask;\n\n  // Download button\n  var downloadCounter = 0;\n  link.addEventListener(\"click\", downloadImage, false);\n  function downloadImage(e) {\n    startTask();\n    e.preventDefault();\n    var filename = originalFileName + \"-minimage-\" + downloadCounter + \".png\";\n    mergeCanvasAndImage(canvas, OrginalImage);\n    downloadCanvas(canvas, filename, endTask);\n    downloadCounter++;\n  }\n}\n\nfunction downloadCanvas(canvas, filename, callback) {\n  canvas.toBlob(function (blob) {\n    if (window.navigator.msSaveOrOpenBlob) {\n      window.navigator.msSaveBlob(blob, filename);\n    } else {\n      var url = window.URL.createObjectURL(blob);\n      var link = document.createElement(\"a\");\n      document.body.appendChild(link);\n      link.setAttribute(\"href\", url);\n      link.setAttribute(\"download\", filename);\n      link.click();\n      setTimeout(callback);\n      setTimeout(function () {\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(link);\n      }, 3000);\n    }\n  });\n}\n\nfunction mergeCanvasAndImage(canvas, img) {\n  // Pastes the image as a canvas background\n  var ctx = canvas.getContext(\"2d\");\n  var oldComposite = ctx.globalCompositeOperation;\n  ctx.globalCompositeOperation = \"destination-over\";\n\n  // Draw the orignal image\n  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n  ctx.globalCompositeOperation = oldComposite;\n\n  return canvas;\n}\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(4);\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\n__webpack_require__(5);\n\nvar _colorPicker = __webpack_require__(6);\n\nvar _colorPicker2 = _interopRequireDefault(_colorPicker);\n\nvar _getAnImage = __webpack_require__(8);\n\nvar _getAnImage2 = _interopRequireDefault(_getAnImage);\n\nvar _toggleAbleBackground = __webpack_require__(9);\n\nvar _toggleAbleBackground2 = _interopRequireDefault(_toggleAbleBackground);\n\nvar _editableCanvas = __webpack_require__(10);\n\nvar _editableCanvas2 = _interopRequireDefault(_editableCanvas);\n\nvar _canvasMergerAndDonwloaderLink = __webpack_require__(2);\n\nvar _pencilSizeSlider = __webpack_require__(11);\n\nvar _pencilSizeSlider2 = _interopRequireDefault(_pencilSizeSlider);\n\nvar _welcomeAnim2 = __webpack_require__(1);\n\nvar _welcomeAnim3 = _interopRequireDefault(_welcomeAnim2);\n\nvar _checkRunWithinWebview = __webpack_require__(12);\n\nvar _spinners = __webpack_require__(13);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\n\nSee the app in action here : https://minimage.tk\n\n*/\nvar byId = document.getElementById.bind(document);\n\n(0, _checkRunWithinWebview.checkRunWithinWebview)();\nvar originalFileName = void 0,\n    OrginalImage = void 0;\n(0, _getAnImage2.default)({\n  fileinput: byId(\"fileinput\"),\n  onImageCreated: function onImageCreated(img, filename) {\n    originalFileName = filename;\n    letUserDrawAndDownload(img);\n  },\n  startTask: _spinners.startTask,\n  endTask: _spinners.endTask\n});\n\nvar _welcomeAnim = (0, _welcomeAnim3.default)(byId(\"welcome\"), { fitWindow: true }),\n    stopAnim = _welcomeAnim.stopAnim,\n    bgColor = _welcomeAnim.bgColor;\n\nbyId(\"fileInputWrapper\").style.color = bgColor;\n\n// Lets the user draw on the loaded image\nfunction letUserDrawAndDownload(img) {\n  OrginalImage = img;\n  stopAnim();\n  var canvas = byId(\"drawzone\"),\n      drawzoneWrapper = byId(\"drawzoneWrapper\");\n\n  // Switch to drawing mode\n  byId(\"inputForAFile\").style.display = \"none\";\n  byId(\"drawAndDownload\").style.display = \"\";\n\n  console.log(img.width, img.height);\n  var maxRes = 3000; //Math.max(img.width, img.height);\n  // Fits the canvas to screen\n  var imgScale = Math.max(img.width / maxRes, img.height / maxRes, 1);\n  img.width = canvas.width = img.width / imgScale;\n  img.height = canvas.height = img.height / imgScale;\n  drawzoneWrapper.style.maxWidth = img.width;\n  drawzoneWrapper.style.maxHeight = img.height;\n\n  // Needs to happen AFTER size measurements\n  drawzoneWrapper.appendChild(img);\n\n  var ctx = canvas.getContext(\"2d\");\n  var hasDoneFirstDraw = false;\n  var barClass = byId(\"topbar\").classList;\n\n  var background = byId(\"background\");\n\n  var _setupColorPicker = (0, _colorPicker2.default)(byId(\"pensizePreview\"), {\n    canvasForCursor: canvas,\n    onColorChange: setColor,\n    elementToContrastWith: background\n  }),\n      setColorDotSize = _setupColorPicker.setColorDotSize,\n      refreshColorPreviewBorder = _setupColorPicker.refreshColorPreviewBorder;\n\n  var _setupEditableCanvas = (0, _editableCanvas2.default)(canvas, {\n    onMouseDown: function onMouseDown() {\n      if (canvas.getClientRects()[0].height + 2 * 70 > window.innerHeight) {\n        barClass.add(\"drawInProgress\");\n      }\n    },\n    onMouseUp: function onMouseUp() {\n      if (!hasDoneFirstDraw) {\n        hasDoneFirstDraw = true;\n        download.classList.add(\"usable\");\n      }\n      barClass.remove(\"drawInProgress\");\n    },\n\n    OrginalImage: OrginalImage\n  }),\n      drawWithColor = _setupEditableCanvas.drawWithColor,\n      drawWithEraser = _setupEditableCanvas.drawWithEraser,\n      setPencilSize = _setupEditableCanvas.setPencilSize;\n\n  // Sets draw color at load and when user clicks color input\n\n\n  function setColor(color) {\n    if (color == \"eraser\") {\n      drawWithEraser();\n    } else {\n      drawWithColor(color);\n    }\n  }\n  // Tap the background to switch its color (usefull for transparent images)\n  (0, _toggleAbleBackground2.default)(background, { onChange: refreshColorPreviewBorder });\n\n  (0, _pencilSizeSlider2.default)(byId(\"pensize\"), {\n    onChange: function onChange(pxSize) {\n      setColorDotSize(pxSize);\n      setPencilSize(pxSize);\n    }\n  });\n\n  (0, _canvasMergerAndDonwloaderLink.makeDownloadLink)(byId(\"download\"), {\n    OrginalImage: OrginalImage,\n    originalFileName: originalFileName,\n    canvas: canvas,\n    startTask: _spinners.startTask,\n    endTask: _spinners.endTask\n  });\n}\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (pensizePreview, _ref) {\n  var onColorChange = _ref.onColorChange,\n      elementToContrastWith = _ref.elementToContrastWith,\n      canvasForCursor = _ref.canvasForCursor;\n\n  var pensizePreviewDot = pensizePreview.children[0];\n\n  function refreshColorPreviewBorder() {\n    pensizePreviewDot.style.border = \"1px solid \" + borderColor(currentColor, elementToContrastWith.style.backgroundColor);\n  }\n\n  var currentColor = void 0;\n  pensizePreview.addEventListener(\"click\", function () {\n    return openColorPicker(currentColor, onColorPicked);\n  });\n  function onColorPicked(color) {\n    currentColor = color;\n    setCursor(canvasForCursor, currentSize, currentColor);\n    if (color == \"eraser\") {\n      pensizePreviewDot.style.background = \"\";\n      pensizePreviewDot.classList.add(\"eraser\");\n    } else {\n      pensizePreviewDot.classList.remove(\"eraser\");\n      pensizePreviewDot.style.background = color;\n      localStorage.setItem(\"color\", color);\n      refreshColorPreviewBorder();\n    }\n    onColorChange(color);\n  }\n  var currentSize = void 0;\n  function setColorDotSize(pxSize) {\n    currentSize = pxSize;\n    setCursor(canvasForCursor, currentSize, currentColor);\n    pensizePreviewDot.style.transform = \"scale(\" + pxSize / 10 + \")\";\n  }\n\n  setTimeout(function () {\n    return onColorPicked(localStorage.getItem(\"color\") || DEFAULTCOLOR);\n  });\n\n  return {\n    setColorDotSize: setColorDotSize,\n    refreshColorPreviewBorder: refreshColorPreviewBorder\n  };\n};\n\nvar _colorToRGB = __webpack_require__(0);\n\nvar _palette = __webpack_require__(7);\n\nvar DEFAULTCOLOR = \"#2b76ce\";\n\n\nfunction borderColor(foreground, background) {\n  if (foreground == \"eraser\") return \"transparent\";\n  var bgL = (0, _colorToRGB.luminance)(background);\n  var fgL = (0, _colorToRGB.luminance)(foreground);\n  if (bgL > 125 && fgL > 200) return \"black\";\n  if (bgL < 125 && fgL < 25) return \"white\";\n  return \"transparent\";\n}\n\nfunction textColor(background) {\n  return (0, _colorToRGB.luminance)(background) > 255 / 2 ? \"rgba(0,0,0,0.8)\" : \"rgba(255,255,255,0.8)\";\n}\n\nfunction openColorPicker(currentColor, callback) {\n  var modal = document.createElement(\"div\");\n  modal.classList.add(\"modal\");\n  document.body.appendChild(modal);\n\n  function pickColor(color) {\n    closeModal();\n    callback(color);\n  }\n\n  _palette.paletteColors.forEach(function (color) {\n    var button = document.createElement(\"button\");\n    button.classList.add(\"colorbutton\");\n    if (color === currentColor) {\n      button.classList.add(\"active\");\n      button.innerHTML = \"Selected\";\n      button.style.color = textColor(color);\n    }\n    button.style.backgroundColor = color.toLowerCase();\n    button.addEventListener(\"click\", function () {\n      return pickColor(color);\n    });\n    modal.appendChild(button);\n  });\n\n  var eraser = document.createElement(\"button\");\n  eraser.classList.add(\"eraser\");\n  eraser.addEventListener(\"click\", function () {\n    return pickColor(\"eraser\");\n  });\n  eraser.innerHTML = '<img src=\"/images/eraser-color.svg\"/><span class=\"imagelabel\">' + (\"eraser\" === currentColor ? \"Eraser selected\" : \"Eraser\") + \"</span>\";\n  modal.appendChild(eraser);\n\n  function closeModal() {\n    modal.classList.add(\"closing\");\n    setTimeout(function () {\n      return document.body.removeChild(modal);\n    }, 300);\n  }\n}\n\nfunction setCursor(node, size, color) {\n  var s = size < 4 ? 4 : size;\n  var c = document.createElement(\"canvas\");\n  c.width = c.height = s;\n  var ctx = c.getContext(\"2d\");\n\n  if (color == \"eraser\") drawEraser(ctx, s);else drawColorCircle(ctx, s, color);\n  var cursor = c.toDataURL(\"image/png\");\n  node.style.cursor = \"url(\" + cursor + \") \" + s / 2 + \" \" + s / 2 + \",auto\";\n}\n\nfunction drawColorCircle(ctx, s, color) {\n  ctx.beginPath();\n  ctx.arc(s / 2, s / 2, s / 2, 0, 2 * Math.PI, false);\n  ctx.fillStyle = color;\n  ctx.fill();\n}\n\nfunction drawEraser(ctx, s) {\n  ctx.fillStyle = \"#da502d\";\n  ctx.fillRect(0, 0, s * 2 / 3, s);\n  ctx.fillStyle = \"#6584a5\";\n  ctx.fillRect(s * 2 / 3 - 1, 0, s, s);\n  ctx.globalCompositeOperation = \"destination-in\";\n  drawColorCircle(ctx, s, \"white\");\n}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar paletteColors = exports.paletteColors = \"#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B\".split(\",\");\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (_ref) {\n  var onImageCreated = _ref.onImageCreated,\n      fileinput = _ref.fileinput,\n      _ref$startTask = _ref.startTask,\n      startTask = _ref$startTask === undefined ? function () {\n    return null;\n  } : _ref$startTask,\n      _ref$endTask = _ref.endTask,\n      endTask = _ref$endTask === undefined ? function () {\n    return null;\n  } : _ref$endTask;\n\n  // Callbacks onImageCreated with img tag and filename\n  var originalFileName = \"pasted-image\";\n  var askingForImage = true;\n\n  // Transforms the file input content to a real image\n  function loadFile(fileToLoad) {\n    startTask();\n    var fileReader = new FileReader();\n    fileReader.onload = function () {\n      createImageWithFileContent(fileReader.result);\n      endTask();\n    };\n    fileReader.onerror = endTask;\n    fileReader.readAsDataURL(fileToLoad);\n  }\n\n  function createImageWithFileContent(result) {\n    startTask();\n    if (!askingForImage) return;\n    var img = new Image();\n    img.onload = function () {\n      askingForImage = false;\n      onImageCreated(img, originalFileName);\n      endTask();\n    };\n    img.onerror = endTask;\n    img.src = result;\n  }\n\n  // Setup of the welcome  UI\n  function askForImage() {\n    fileinput && fileinput.addEventListener(\"change\", fileChanged);\n    function fileChanged(changeEvent) {\n      fileinput.removeEventListener(\"change\", fileChanged);\n      originalFileName = fileinput.value.split(\"\\\\\").pop().split(\".\")[0] || \"image\";\n      loadFile(changeEvent.target.files[0]);\n    }\n  }\n\n  askForImage();\n\n  window.addEventListener(\"paste\", function (ev) {\n    handleDataTransferItems(ev.clipboardData.items);\n  });\n\n  document.body.addEventListener(\"dragover\", function (ev) {\n    ev.preventDefault();\n    ev.stopPropagation();\n  });\n  document.body.addEventListener(\"drop\", function (ev) {\n    ev.preventDefault();\n    ev.stopPropagation();\n    handleDataTransferItems(ev.dataTransfer.items);\n  });\n\n  function handleDataTransferItems(items) {\n    // Tries to paste an image\n    var imageFile = Array.prototype.find.call(items, function (e) {\n      return e.kind == \"file\" && e.type.match(\"image\");\n    });\n    originalFileName = \"pasted-image\";\n    if (imageFile) {\n      loadFile(imageFile.getAsFile());\n      return;\n    }\n    // Tries to load a remote image given its adress\n    var url = Array.prototype.find.call(items, function (e) {\n      return e.kind == \"string\";\n    });\n    if (url) {\n      url.getAsString(function (s) {\n        return createImageWithFileContent(s);\n      });\n    }\n  }\n};\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (background, _ref) {\n  var onChange = _ref.onChange;\n\n  function switchBackground() {\n    currentMode++;\n    localStorage.setItem(\"background\", currentMode);\n    applyBackground();\n  }\n  var switchCount = 0;\n  function applyBackground() {\n    var options = [\"#DDD\", \"#333\"];\n    var current = currentMode % options.length;\n    background.style.backgroundColor = options[current];\n    onChange(current);\n\n    var bclass = document.body.classList;\n    options.forEach(function (color, index) {\n      return bclass.remove(\"background_n_\" + index);\n    });\n    bclass.add(\"background_n_\" + current);\n    // https://www.youtube.com/watch?v=Pr8ETbGz35Q\n    if (switchCount < 8) {\n      console.log(current == 0 ? \"jour !\" : \"nuit !\");\n      switchCount++;\n    } else {\n      console.log(\"Monsieur Jacquouille, je vous en prie, à la longue, ça devient casse-pied !\");\n    }\n  }\n  var currentMode = localStorage.getItem(\"background\") || 0;\n  applyBackground();\n  background.addEventListener(\"click\", switchBackground);\n};\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (canvas, _ref) {\n  var onMouseDown = _ref.onMouseDown,\n      onMouseUp = _ref.onMouseUp,\n      OrginalImage = _ref.OrginalImage;\n\n  // We cache some zoom related data to avoid getting them all the time\n  var scale = void 0,\n      rect = void 0,\n      lastUsedPXsize = void 0;\n\n  function measureScale() {\n    rect = canvas.getBoundingClientRect();\n    scale = rect.width / canvas.width;\n    if (lastUsedPXsize && ctx) {\n      ctx.lineWidth = lastUsedPXsize / scale;\n    }\n  }\n  measureScale();\n\n  window.addEventListener(\"resize\", measureScale);\n\n  var ctx = canvas.getContext(\"2d\");\n\n  // To make the lines look slightly nicer\n  ctx.lineCap = \"round\";\n\n  // We cache the mouse position and previous mouse position.\n  // Theay are defined by touch events, and used by the draw loop\n  var mousePos = {\n    x: 0,\n    y: 0\n  },\n      lastPos = mousePos;\n\n  canvas.addEventListener(\"mousedown\", function (e) {\n    if (e.which == 3) {\n      // We detected a right click on canvas, probably to save it.\n      // We merge the content of the background image with the canvas\n      (0, _canvasMergerAndDonwloaderLink.mergeCanvasAndImage)(canvas, OrginalImage);\n      return;\n    }\n    mousePos = lastPos = getMousePos(e);\n    startDrawLoop();\n    onMouseDown();\n  }, false);\n\n  // Allow ctrl-c > pasting to word & co\n  document.addEventListener(\"copy\", function (ev) {\n    ev.preventDefault();\n    (0, _canvasMergerAndDonwloaderLink.mergeCanvasAndImage)(canvas, OrginalImage);\n    ev.clipboardData.setData(\"text/html\", '<img src=\"' + canvas.toDataURL() + '\"/>');\n  });\n\n  document.addEventListener(\"mouseup\", endDrawLoop, false);\n\n  canvas.addEventListener(\"mousemove\", function (e) {\n    mousePos = getMousePos(e);\n  }, false);\n\n  // Get the position of the mouse relative to the canvas\n  function getMousePos(mouseEvent) {\n    return {\n      x: (mouseEvent.clientX - rect.left) / scale,\n      y: (mouseEvent.clientY - rect.top) / scale\n    };\n  }\n\n  // Drawing loop is separated from the events￼\n\n  var isDrawing = false;\n\n  function startDrawLoop() {\n    if (isDrawing) return;\n    isDrawing = true;\n    ctx.beginPath();\n    drawLoop();\n  }\n  function endDrawLoop() {\n    isDrawing && onMouseUp();\n    isDrawing = false;\n  }\n\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n  function renderCanvas() {\n    ctx.moveTo(lastPos.x, lastPos.y);\n    ctx.lineTo(mousePos.x, mousePos.y);\n    ctx.stroke();\n    lastPos = mousePos;\n  }\n\n  // Proxy mobile events to their mouse counterpart\n  function proxyTouchToMouse(touchEventName, mouseEventName) {\n    var eventTarget = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : canvas;\n\n    canvas.addEventListener(touchEventName, function (e) {\n      e.preventDefault();\n\n      var _ref2 = e.touches[0] || {},\n          clientX = _ref2.clientX,\n          clientY = _ref2.clientY;\n\n      var mouseEvent = new MouseEvent(mouseEventName, {\n        clientX: clientX,\n        clientY: clientY\n      });\n      eventTarget.dispatchEvent(mouseEvent);\n    }, false);\n  }\n  proxyTouchToMouse(\"touchstart\", \"mousedown\");\n  proxyTouchToMouse(\"touchend\", \"mouseup\", document);\n  proxyTouchToMouse(\"touchmove\", \"mousemove\");\n\n  return {\n    drawWithEraser: function drawWithEraser() {\n      ctx.globalCompositeOperation = \"destination-out\";\n    },\n    drawWithColor: function drawWithColor(color) {\n      ctx.globalCompositeOperation = \"source-over\";\n      ctx.strokeStyle = color;\n    },\n    setPencilSize: function setPencilSize(pxSize) {\n      lastUsedPXsize = pxSize;\n      ctx.lineWidth = pxSize / scale;\n    }\n  };\n};\n\nvar _canvasMergerAndDonwloaderLink = __webpack_require__(2);\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = function (slider, _ref) {\n  var onChange = _ref.onChange;\n\n  // Sets draw size at load and style when the user interracts with the slider\n  function onPencilSizeChange(pxSize) {\n    slider.value = pxSize;\n    localStorage.setItem(\"pensize\", pxSize);\n    onChange(pxSize);\n  }\n  slider.addEventListener(\"input\", function (e) {\n    return onPencilSizeChange(e.target.value);\n  });\n  onPencilSizeChange(parseInt(localStorage.getItem(\"pensize\")) || DEFAULTSIZE);\n};\n\nvar DEFAULTSIZE = 20;\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkRunWithinWebview = checkRunWithinWebview;\nfunction checkRunWithinWebview() {\n  if (navigator.userAgent.match(/Android/i)) {\n    var JSONPcall = document.createElement(\"script\");\n    JSONPcall.src = \"https://iswebview.herokuapp.com/?callback=JSONPcallback\";\n    // JSONPcall.src = \"https://iswebview2repo-iswebview2.7e14.starter-us-west-2.openshiftapps.com/?callback=JSONPcallback\";\n    document.body.appendChild(JSONPcall);\n  }\n}\nwindow.JSONPcallback = function (result) {\n  if (result.isWebView) {\n    document.body.classList.add(\"runningWithinWebview\");\n    document.body.innerHTML = \"\\n      Please open minimage.tk with chrome,\\n       it cannot work within another app.\\n\\n        There may be an option in the menu above the page,\\n         something like \\\"Open in Chrome\\\".\\n\\n         \";\n  }\n};\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.startTask = startTask;\nexports.endTask = endTask;\nexports.updateLook = updateLook;\nvar tasksInProgress = 0;\nfunction startTask() {\n  tasksInProgress++;\n  updateLook();\n}\n\nfunction endTask() {\n  tasksInProgress--;\n  setTimeout(updateLook);\n}\n\nfunction updateLook() {\n  spinners.classList[tasksInProgress ? \"remove\" : \"add\"](\"hidden\");\n}\ndocument.addEventListener(\"DOMContentLoaded\", updateLook);\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ff0baf3075c4e74db0d4","export function colorToRGB(color) {\n  var canvas = document.createElement(\"canvas\");\n  canvas.width = canvas.height = 1;\n  var ctx = canvas.getContext(\"2d\");\n  ctx.clearRect(0, 0, 1, 1);\n  ctx.fillStyle = color;\n  ctx.fillRect(0, 0, 1, 1);\n  return [...ctx.getImageData(0, 0, 1, 1).data].slice(0, 3);\n}\n\nexport function luminance(color) {\n  return colorToRGB(color).reduce((a, b) => a + b, 0) / 3;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/colorToRGB.js","import { luminance } from \"./colorToRGB.js\";\nconst coolColors = \"#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722\".split(\n  \",\"\n);\nconst darkCoolColors = coolColors.filter(c => luminance(c) < 150);\n\nfunction randomColor(colorPool, exception = \"\") {\n  let withoutEx = colorPool.filter(c => c != exception);\n  return withoutEx[Math.floor(Math.random() * (withoutEx.length + 0.99))];\n}\n\nexport default function(canvas, { fitWindow }) {\n  let ctx, w, h;\n  let bgColor = randomColor(darkCoolColors);\n  function reset() {\n    if (fitWindow) {\n      canvas.width = window.innerWidth;\n      canvas.height = window.innerHeight;\n    }\n    w = canvas.width;\n    h = canvas.height;\n    ctx = canvas.getContext(\"2d\");\n    ctx.fillStyle = bgColor;\n    ctx.fillRect(0, 0, w, h);\n    ctx.lineCap = \"round\";\n    randomizeInst();\n  }\n\n  let position, speed, acceleration, timeoutHandle, accelerationTimeoutHandle;\n  function randomizeInst() {\n    position = {\n      // x: Math.random() * w,\n      // y: Math.random() * h\n      x: w / 2,\n      y: h / 2\n    };\n    speed = {\n      x: Math.random() * 10 - 5,\n      y: Math.random() * 10 - 5\n    };\n    acceleration = {\n      x: Math.random() * 10 - 5,\n      y: Math.random() * 10 - 5\n    };\n\n    ctx.strokeStyle = randomColor(coolColors, bgColor);\n    ctx.lineWidth = 20 + Math.random() * 40;\n    ctx.beginPath();\n    ctx.moveTo(position.x, position.y);\n  }\n\n  reset();\n  window.addEventListener(\"resize\", reset);\n\n  function randomAcceletation() {\n    acceleration = {\n      x: Math.random() * 2 - 1,\n      y: Math.random() * 2 - 1\n    };\n    // speed.x*=0.2;\n    // speed.y*=0.2;\n\n    accelerationTimeoutHandle = setTimeout(\n      randomAcceletation,\n      100 + Math.random() * 200\n    );\n  }\n  randomAcceletation();\n  function renderCanvas() {\n    ctx.moveTo(position.x, position.y);\n    speed.x *= 0.95;\n    speed.y *= 0.95;\n\n    speed.x += acceleration.x;\n    speed.y += acceleration.y;\n    position.x += speed.x;\n    position.y += speed.y;\n    ctx.lineTo(position.x, position.y);\n    ctx.stroke();\n    if (\n      position.x < -50 ||\n      position.x > w + 50 ||\n      position.y < -50 ||\n      position.y > h + 50\n    )\n      randomizeInst();\n  }\n\n  let isDrawing = true;\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n\n  drawLoop();\n\n  function stopAnim() {\n    isDrawing = false;\n    clearTimeout(accelerationTimeoutHandle);\n    window.removeEventListener(\"resize\", reset);\n  }\n\n  return {\n    stopAnim,\n    bgColor\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/welcomeAnim.js","export function makeDownloadLink(\n  link,\n  { OrginalImage, canvas, originalFileName, startTask, endTask }\n) {\n  // Download button\n  var downloadCounter = 0;\n  link.addEventListener(\"click\", downloadImage, false);\n  function downloadImage(e) {\n    startTask();\n    e.preventDefault();\n    let filename = originalFileName + \"-minimage-\" + downloadCounter + \".png\";\n    mergeCanvasAndImage(canvas, OrginalImage);\n    downloadCanvas(canvas, filename, endTask);\n    downloadCounter++;\n  }\n}\n\nfunction downloadCanvas(canvas, filename, callback) {\n  canvas.toBlob(function(blob) {\n    if (window.navigator.msSaveOrOpenBlob) {\n      window.navigator.msSaveBlob(blob, filename);\n    } else {\n      let url = window.URL.createObjectURL(blob);\n      let link = document.createElement(\"a\");\n      document.body.appendChild(link);\n      link.setAttribute(\"href\", url);\n      link.setAttribute(\"download\", filename);\n      link.click();\n      setTimeout(callback);\n      setTimeout(() => {\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(link);\n      }, 3000);\n    }\n  });\n}\n\nexport function mergeCanvasAndImage(canvas, img) {\n  // Pastes the image as a canvas background\n  var ctx = canvas.getContext(\"2d\");\n  let oldComposite = ctx.globalCompositeOperation;\n  ctx.globalCompositeOperation = \"destination-over\";\n\n  // Draw the orignal image\n  ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n\n  ctx.globalCompositeOperation = oldComposite;\n\n  return canvas;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/canvasMergerAndDonwloaderLink.js","/*\n\nSee the app in action here : https://minimage.tk\n\n*/\nimport \"./styles.less\";\nimport setupColorPicker from \"./colorPicker.js\";\nimport askForIMG from \"./getAnImage.js\";\nimport toggleAbleBackground from \"./toggleAbleBackground.js\";\nimport setupEditableCanvas from \"./editableCanvas.js\";\nimport { makeDownloadLink } from \"./canvasMergerAndDonwloaderLink.js\";\nimport pencilSizeSlider from \"./pencilSizeSlider.js\";\nimport welcomeAnim from \"./welcomeAnim.js\";\nimport { checkRunWithinWebview } from \"./checkRunWithinWebview.js\";\nimport { startTask, endTask } from \"./spinners.js\";\nconst byId = document.getElementById.bind(document);\n\ncheckRunWithinWebview();\nlet originalFileName, OrginalImage;\naskForIMG({\n  fileinput: byId(\"fileinput\"),\n  onImageCreated: (img, filename) => {\n    originalFileName = filename;\n    letUserDrawAndDownload(img);\n  },\n  startTask,\n  endTask\n});\n\nlet { stopAnim, bgColor } = welcomeAnim(byId(\"welcome\"), { fitWindow: true });\nbyId(\"fileInputWrapper\").style.color = bgColor;\n\n// Lets the user draw on the loaded image\nfunction letUserDrawAndDownload(img) {\n  OrginalImage = img;\n  stopAnim();\n  const canvas = byId(\"drawzone\"),\n    drawzoneWrapper = byId(\"drawzoneWrapper\");\n\n  // Switch to drawing mode\n  byId(\"inputForAFile\").style.display = \"none\";\n  byId(\"drawAndDownload\").style.display = \"\";\n\n  console.log(img.width, img.height);\n  let maxRes = 3000; //Math.max(img.width, img.height);\n  // Fits the canvas to screen\n  let imgScale = Math.max(img.width / maxRes, img.height / maxRes, 1);\n  img.width = canvas.width = img.width / imgScale;\n  img.height = canvas.height = img.height / imgScale;\n  drawzoneWrapper.style.maxWidth = img.width;\n  drawzoneWrapper.style.maxHeight = img.height;\n\n  // Needs to happen AFTER size measurements\n  drawzoneWrapper.appendChild(img);\n\n  let ctx = canvas.getContext(\"2d\");\n  let hasDoneFirstDraw = false;\n  let barClass = byId(\"topbar\").classList;\n\n  let background = byId(\"background\");\n\n  const { setColorDotSize, refreshColorPreviewBorder } = setupColorPicker(\n    byId(\"pensizePreview\"),\n    {\n      canvasForCursor: canvas,\n      onColorChange: setColor,\n      elementToContrastWith: background\n    }\n  );\n\n  let {\n    drawWithColor,\n    drawWithEraser,\n    setPencilSize\n  } = setupEditableCanvas(canvas, {\n    onMouseDown() {\n      if (canvas.getClientRects()[0].height + 2 * 70 > window.innerHeight) {\n        barClass.add(\"drawInProgress\");\n      }\n    },\n    onMouseUp() {\n      if (!hasDoneFirstDraw) {\n        hasDoneFirstDraw = true;\n        download.classList.add(\"usable\");\n      }\n      barClass.remove(\"drawInProgress\");\n    },\n    OrginalImage\n  });\n\n  // Sets draw color at load and when user clicks color input\n  function setColor(color) {\n    if (color == \"eraser\") {\n      drawWithEraser();\n    } else {\n      drawWithColor(color);\n    }\n  }\n  // Tap the background to switch its color (usefull for transparent images)\n  toggleAbleBackground(background, { onChange: refreshColorPreviewBorder });\n\n  pencilSizeSlider(byId(\"pensize\"), {\n    onChange(pxSize) {\n      setColorDotSize(pxSize);\n      setPencilSize(pxSize);\n    }\n  });\n\n  makeDownloadLink(byId(\"download\"), {\n    OrginalImage,\n    originalFileName,\n    canvas,\n    startTask,\n    endTask\n  });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","const DEFAULTCOLOR = \"#2b76ce\";\nimport { luminance } from \"./colorToRGB.js\";\nimport { paletteColors } from \"./palette.js\";\nexport default function(\n  pensizePreview,\n  { onColorChange, elementToContrastWith, canvasForCursor }\n) {\n  const pensizePreviewDot = pensizePreview.children[0];\n\n  function refreshColorPreviewBorder() {\n    pensizePreviewDot.style.border =\n      \"1px solid \" +\n      borderColor(currentColor, elementToContrastWith.style.backgroundColor);\n  }\n\n  let currentColor;\n  pensizePreview.addEventListener(\"click\", () =>\n    openColorPicker(currentColor, onColorPicked)\n  );\n  function onColorPicked(color) {\n    currentColor = color;\n    setCursor(canvasForCursor, currentSize, currentColor);\n    if (color == \"eraser\") {\n      pensizePreviewDot.style.background = \"\";\n      pensizePreviewDot.classList.add(\"eraser\");\n    } else {\n      pensizePreviewDot.classList.remove(\"eraser\");\n      pensizePreviewDot.style.background = color;\n      localStorage.setItem(\"color\", color);\n      refreshColorPreviewBorder();\n    }\n    onColorChange(color);\n  }\n  let currentSize;\n  function setColorDotSize(pxSize) {\n    currentSize = pxSize;\n    setCursor(canvasForCursor, currentSize, currentColor);\n    pensizePreviewDot.style.transform = \"scale(\" + pxSize / 10 + \")\";\n  }\n\n  setTimeout(() =>\n    onColorPicked(localStorage.getItem(\"color\") || DEFAULTCOLOR)\n  );\n\n  return {\n    setColorDotSize,\n    refreshColorPreviewBorder\n  };\n}\n\nfunction borderColor(foreground, background) {\n  if (foreground == \"eraser\") return \"transparent\";\n  let bgL = luminance(background);\n  let fgL = luminance(foreground);\n  if (bgL > 125 && fgL > 200) return \"black\";\n  if (bgL < 125 && fgL < 25) return \"white\";\n  return \"transparent\";\n}\n\nfunction textColor(background) {\n  return luminance(background) > 255 / 2\n    ? \"rgba(0,0,0,0.8)\"\n    : \"rgba(255,255,255,0.8)\";\n}\n\nfunction openColorPicker(currentColor, callback) {\n  let modal = document.createElement(\"div\");\n  modal.classList.add(\"modal\");\n  document.body.appendChild(modal);\n\n  function pickColor(color) {\n    closeModal();\n    callback(color);\n  }\n\n  paletteColors.forEach(color => {\n    let button = document.createElement(\"button\");\n    button.classList.add(\"colorbutton\");\n    if (color === currentColor) {\n      button.classList.add(\"active\");\n      button.innerHTML = \"Selected\";\n      button.style.color = textColor(color);\n    }\n    button.style.backgroundColor = color.toLowerCase();\n    button.addEventListener(\"click\", () => pickColor(color));\n    modal.appendChild(button);\n  });\n\n  let eraser = document.createElement(\"button\");\n  eraser.classList.add(\"eraser\");\n  eraser.addEventListener(\"click\", () => pickColor(\"eraser\"));\n  eraser.innerHTML =\n    '<img src=\"/images/eraser-color.svg\"/><span class=\"imagelabel\">' +\n    (\"eraser\" === currentColor ? \"Eraser selected\" : \"Eraser\") +\n    \"</span>\";\n  modal.appendChild(eraser);\n\n  function closeModal() {\n    modal.classList.add(\"closing\");\n    setTimeout(() => document.body.removeChild(modal), 300);\n  }\n}\n\nfunction setCursor(node, size, color) {\n  let s = size < 4 ? 4 : size;\n  let c = document.createElement(\"canvas\");\n  c.width = c.height = s;\n  let ctx = c.getContext(\"2d\");\n\n  if (color == \"eraser\") drawEraser(ctx, s);\n  else drawColorCircle(ctx, s, color);\n  let cursor = c.toDataURL(\"image/png\");\n  node.style.cursor = `url(${cursor}) ${s / 2} ${s / 2},auto`;\n}\n\nfunction drawColorCircle(ctx, s, color) {\n  ctx.beginPath();\n  ctx.arc(s / 2, s / 2, s / 2, 0, 2 * Math.PI, false);\n  ctx.fillStyle = color;\n  ctx.fill();\n}\n\nfunction drawEraser(ctx, s) {\n  ctx.fillStyle = \"#da502d\";\n  ctx.fillRect(0, 0, s * 2 / 3, s);\n  ctx.fillStyle = \"#6584a5\";\n  ctx.fillRect(s * 2 / 3 - 1, 0, s, s);\n  ctx.globalCompositeOperation = \"destination-in\";\n  drawColorCircle(ctx, s, \"white\");\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/colorPicker.js","export const paletteColors = \"#000000,#FFFFFF,#F44336,#E91E63,#9C27B0,#673AB7,#3F51B5,#2196F3,#03A9F4,#00BCD4,#009688,#4CAF50,#8BC34A,#CDDC39,#FFEB3B,#FFC107,#FF9800,#FF5722,#795548,#9E9E9E,#607D8B\".split(\n  \",\"\n);\n\n\n\n// WEBPACK FOOTER //\n// ./src/palette.js","export default function({\n  onImageCreated,\n  fileinput,\n  startTask = () => null,\n  endTask = () => null\n}) {\n  // Callbacks onImageCreated with img tag and filename\n  let originalFileName = \"pasted-image\";\n  let askingForImage = true;\n\n  // Transforms the file input content to a real image\n  function loadFile(fileToLoad) {\n    startTask();\n    let fileReader = new FileReader();\n    fileReader.onload = () => {\n      createImageWithFileContent(fileReader.result);\n      endTask();\n    };\n    fileReader.onerror = endTask;\n    fileReader.readAsDataURL(fileToLoad);\n  }\n\n  function createImageWithFileContent(result) {\n    startTask();\n    if (!askingForImage) return;\n    let img = new Image();\n    img.onload = () => {\n      askingForImage = false;\n      onImageCreated(img, originalFileName);\n      endTask();\n    };\n    img.onerror = endTask;\n    img.src = result;\n  }\n\n  // Setup of the welcome  UI\n  function askForImage() {\n    fileinput && fileinput.addEventListener(\"change\", fileChanged);\n    function fileChanged(changeEvent) {\n      fileinput.removeEventListener(\"change\", fileChanged);\n      originalFileName =\n        fileinput.value.split(\"\\\\\").pop().split(\".\")[0] || \"image\";\n      loadFile(changeEvent.target.files[0]);\n    }\n  }\n\n  askForImage();\n\n  window.addEventListener(\"paste\", function(ev) {\n    handleDataTransferItems(ev.clipboardData.items);\n  });\n\n  document.body.addEventListener(\"dragover\", function(ev) {\n    ev.preventDefault();\n    ev.stopPropagation();\n  });\n  document.body.addEventListener(\"drop\", function(ev) {\n    ev.preventDefault();\n    ev.stopPropagation();\n    handleDataTransferItems(ev.dataTransfer.items);\n  });\n\n  function handleDataTransferItems(items) {\n    // Tries to paste an image\n    let imageFile = Array.prototype.find.call(\n      items,\n      e => e.kind == \"file\" && e.type.match(\"image\")\n    );\n    originalFileName = \"pasted-image\";\n    if (imageFile) {\n      loadFile(imageFile.getAsFile());\n      return;\n    }\n    // Tries to load a remote image given its adress\n    let url = Array.prototype.find.call(items, e => e.kind == \"string\");\n    if (url) {\n      url.getAsString(s => createImageWithFileContent(s));\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/getAnImage.js","export default function(background, { onChange }) {\n  function switchBackground() {\n    currentMode++;\n    localStorage.setItem(\"background\", currentMode);\n    applyBackground();\n  }\n  let switchCount = 0;\n  function applyBackground() {\n    let options = [\"#DDD\", \"#333\"];\n    let current = currentMode % options.length;\n    background.style.backgroundColor = options[current];\n    onChange(current);\n\n    let bclass = document.body.classList;\n    options.forEach((color, index) => bclass.remove(\"background_n_\" + index));\n    bclass.add(\"background_n_\" + current);\n    // https://www.youtube.com/watch?v=Pr8ETbGz35Q\n    if (switchCount < 8) {\n      console.log(current == 0 ? \"jour !\" : \"nuit !\");\n      switchCount++;\n    } else {\n      console.log(\n        \"Monsieur Jacquouille, je vous en prie, à la longue, ça devient casse-pied !\"\n      );\n    }\n  }\n  let currentMode = localStorage.getItem(\"background\") || 0;\n  applyBackground();\n  background.addEventListener(\"click\", switchBackground);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/toggleAbleBackground.js","import { mergeCanvasAndImage } from \"./canvasMergerAndDonwloaderLink.js\";\n\nexport default function(canvas, { onMouseDown, onMouseUp, OrginalImage }) {\n  // We cache some zoom related data to avoid getting them all the time\n  let scale, rect, lastUsedPXsize;\n\n  function measureScale() {\n    rect = canvas.getBoundingClientRect();\n    scale = rect.width / canvas.width;\n    if (lastUsedPXsize && ctx) {\n      ctx.lineWidth = lastUsedPXsize / scale;\n    }\n  }\n  measureScale();\n\n  window.addEventListener(\"resize\", measureScale);\n\n  let ctx = canvas.getContext(\"2d\");\n\n  // To make the lines look slightly nicer\n  ctx.lineCap = \"round\";\n\n  // We cache the mouse position and previous mouse position.\n  // Theay are defined by touch events, and used by the draw loop\n  let mousePos = {\n      x: 0,\n      y: 0\n    },\n    lastPos = mousePos;\n\n  canvas.addEventListener(\n    \"mousedown\",\n    function(e) {\n      if (e.which == 3) {\n        // We detected a right click on canvas, probably to save it.\n        // We merge the content of the background image with the canvas\n        mergeCanvasAndImage(canvas, OrginalImage);\n        return;\n      }\n      mousePos = lastPos = getMousePos(e);\n      startDrawLoop();\n      onMouseDown();\n    },\n    false\n  );\n\n  // Allow ctrl-c > pasting to word & co\n  document.addEventListener(\"copy\", ev => {\n    ev.preventDefault();\n    mergeCanvasAndImage(canvas, OrginalImage);\n    ev.clipboardData.setData(\n      \"text/html\",\n      '<img src=\"' + canvas.toDataURL() + '\"/>'\n    );\n  });\n\n  document.addEventListener(\"mouseup\", endDrawLoop, false);\n\n  canvas.addEventListener(\n    \"mousemove\",\n    function(e) {\n      mousePos = getMousePos(e);\n    },\n    false\n  );\n\n  // Get the position of the mouse relative to the canvas\n  function getMousePos(mouseEvent) {\n    return {\n      x: (mouseEvent.clientX - rect.left) / scale,\n      y: (mouseEvent.clientY - rect.top) / scale\n    };\n  }\n\n  // Drawing loop is separated from the events￼\n\n  let isDrawing = false;\n\n  function startDrawLoop() {\n    if (isDrawing) return;\n    isDrawing = true;\n    ctx.beginPath();\n    drawLoop();\n  }\n  function endDrawLoop() {\n    isDrawing && onMouseUp();\n    isDrawing = false;\n  }\n\n  function drawLoop() {\n    if (isDrawing) {\n      window.requestAnimationFrame(drawLoop);\n      renderCanvas();\n    }\n  }\n  function renderCanvas() {\n    ctx.moveTo(lastPos.x, lastPos.y);\n    ctx.lineTo(mousePos.x, mousePos.y);\n    ctx.stroke();\n    lastPos = mousePos;\n  }\n\n  // Proxy mobile events to their mouse counterpart\n  function proxyTouchToMouse(\n    touchEventName,\n    mouseEventName,\n    eventTarget = canvas\n  ) {\n    canvas.addEventListener(\n      touchEventName,\n      function(e) {\n        e.preventDefault();\n        let { clientX, clientY } = e.touches[0] || {};\n        let mouseEvent = new MouseEvent(mouseEventName, {\n          clientX,\n          clientY\n        });\n        eventTarget.dispatchEvent(mouseEvent);\n      },\n      false\n    );\n  }\n  proxyTouchToMouse(\"touchstart\", \"mousedown\");\n  proxyTouchToMouse(\"touchend\", \"mouseup\", document);\n  proxyTouchToMouse(\"touchmove\", \"mousemove\");\n\n  return {\n    drawWithEraser() {\n      ctx.globalCompositeOperation = \"destination-out\";\n    },\n    drawWithColor(color) {\n      ctx.globalCompositeOperation = \"source-over\";\n      ctx.strokeStyle = color;\n    },\n    setPencilSize(pxSize) {\n      lastUsedPXsize = pxSize;\n      ctx.lineWidth = pxSize / scale;\n    }\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/editableCanvas.js","const DEFAULTSIZE = 20;\nexport default function(slider, { onChange }) {\n  // Sets draw size at load and style when the user interracts with the slider\n  function onPencilSizeChange(pxSize) {\n    slider.value = pxSize;\n    localStorage.setItem(\"pensize\", pxSize);\n    onChange(pxSize);\n  }\n  slider.addEventListener(\"input\", e => onPencilSizeChange(e.target.value));\n  onPencilSizeChange(parseInt(localStorage.getItem(\"pensize\")) || DEFAULTSIZE);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pencilSizeSlider.js","export function checkRunWithinWebview() {\n  if (navigator.userAgent.match(/Android/i)) {\n    let JSONPcall = document.createElement(\"script\");\n    JSONPcall.src = \"https://iswebview.herokuapp.com/?callback=JSONPcallback\";\n    // JSONPcall.src = \"https://iswebview2repo-iswebview2.7e14.starter-us-west-2.openshiftapps.com/?callback=JSONPcallback\";\n    document.body.appendChild(JSONPcall);\n  }\n}\nwindow.JSONPcallback = function(result) {\n  if (result.isWebView) {\n    document.body.classList.add(\"runningWithinWebview\");\n    document.body.innerHTML = `\n      Please open minimage.tk with chrome,\n       it cannot work within another app.\n\n        There may be an option in the menu above the page,\n         something like \"Open in Chrome\".\n\n         `;\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/checkRunWithinWebview.js","let tasksInProgress = 0;\nexport function startTask() {\n  tasksInProgress++;\n  updateLook();\n}\n\nexport function endTask() {\n  tasksInProgress--;\n  setTimeout(updateLook);\n}\n\nexport function updateLook() {\n  spinners.classList[tasksInProgress ? \"remove\" : \"add\"](\"hidden\");\n}\ndocument.addEventListener(\"DOMContentLoaded\", updateLook);\n\n\n\n// WEBPACK FOOTER //\n// ./src/spinners.js"],"sourceRoot":""}